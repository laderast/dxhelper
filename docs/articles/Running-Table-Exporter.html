<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Running Table Exporter • xvhelper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Running Table Exporter">
<meta property="og:description" content="xvhelper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xvhelper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.100</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Running-Table-Exporter.html">Running Table Exporter</a>
    </li>
    <li>
      <a href="../articles/downloading-pheno-data.html">Downloading Pheno Data in JupyterLab/RStudio</a>
    </li>
    <li>
      <a href="../articles/decode_apollo_datasets.html">Decoding Apollo Datasets with xvhelper</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/laderast/xvhelper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Running Table Exporter</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/laderast/xvhelper/blob/HEAD/vignettes/articles/Running-Table-Exporter.Rmd" class="external-link"><code>vignettes/articles/Running-Table-Exporter.Rmd</code></a></small>
      <div class="hidden name"><code>Running-Table-Exporter.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/laderast/xvhelper" class="external-link">xvhelper</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="running-table-exporter">Running Table Exporter<a class="anchor" aria-label="anchor" href="#running-table-exporter"></a>
</h2>
<p>If we have a large number of fields (more than 15-20) to extract from
the pheno data, then our call to <code><a href="../reference/extract_data.html">extract_data()</a></code> may fail.
That is because this functionality is dependent on a shared resource
called the Thrift Server. There is a hard limit to the query execution
time on the Thrift server: 2 minutes.</p>
<p>If our query takes longer, we can launch Table Exporter, which is an
app on the platform that will do the extraction for us. This vignette
outlines how to launch table exporter in your R session, monitor it, and
find the CSV file that was generated by it.</p>
<p>The first thing we need to do is find our dataset’s id, and have a
vector of fields that we’ve generated. Once we have these two items, we
can use <code><a href="../reference/launch_table_exporter.html">launch_table_exporter()</a></code> to start the Table Exporter
app.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_dataset_id.html">find_dataset_id</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"participant.eid"</span>, <span class="st">"participant.p31"</span>, <span class="st">"participant.p41202"</span><span class="op">)</span></span>
<span><span class="va">job_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/launch_table_exporter.html">launch_table_exporter</a></span><span class="op">(</span><span class="va">ds_id</span>, <span class="va">fields</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Job has been submitted as job-GY5vk580Yq38xpKf11bp8QJ5</span></span>
<span><span class="co">#&gt; → Use system("dx watch job-GY5vk580Yq38xpKf11bp8QJ5") to monitor job</span></span>
<span><span class="va">job_id</span></span>
<span><span class="co">#&gt; [1] "job-GY5vk580Yq38xpKf11bp8QJ5"</span></span></code></pre></div>
<p>When our Table Exporter job is running, we can check on its status
using <code><a href="../reference/check_job.html">check_job()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_job.html">check_job</a></span><span class="op">(</span><span class="va">job_id</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Job is currently idle</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>Note that it also returns a <code>NULL</code>. When our job finishes
successfully, it will return a <code>file-id</code> (see below).</p>
<p>The states our job can be are:</p>
<ul>
<li><code>runnable</code></li>
<li><code>running</code></li>
<li><code>failed</code></li>
<li><code>done</code></li>
</ul>
<p>If we need to terminate our Table Exporter Job, we can use
<code><a href="../reference/terminate_job.html">terminate_job()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/terminate_job.html">terminate_job</a></span><span class="op">(</span><span class="va">job_id</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Job job-GY5vk580Yq38xpKf11bp8QJ5 has been terminated</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="successful-table-exporter-run">Successful Table Exporter Run<a class="anchor" aria-label="anchor" href="#successful-table-exporter-run"></a>
</h2>
<p>If our job finishes successfully or fails, we will receive an email
notifiation. If we check on our job again with <code><a href="../reference/check_job.html">check_job()</a></code>.
Here we’re passing in a job ID for a successful run.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_job.html">check_job</a></span><span class="op">(</span><span class="st">"job-GY4Zj180Yq3BJyFzg2ygGVX2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Job is currently done</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> File generated in project storage: file-GY4Zq9j0gJVQxgKGxV7YG6KJ</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Use `system('dx download file-GY4Zq9j0gJVQxgKGxV7YG6KJ')` to download to local storage)</span></span>
<span><span class="va">file_id</span></span>
<span><span class="co">#&gt; [1] "file-GY4Zq9j0gJVQxgKGxV7YG6KJ"</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ted Laderas.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
